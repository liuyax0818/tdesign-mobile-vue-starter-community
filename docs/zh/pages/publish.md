# 发布页 {#publish}

本页面是`发布页`，用户可以通过主页的发布按钮跳转至此页面，发布自己的动态内容。

## 页面思路 {#design-idea}

**本页面的视觉稿如图所示**

![发布页面视觉稿](/images/publish.png)

根据视觉稿的特点，整个页面采用从上至下的垂直布局，依次划分为 `顶部导航栏模块`、`图片上传模块`、`描述输入模块`、`标签选择模块`、`位置选择模块` 和 `底部操作按钮模块` 进行开发。底部操作按钮会固定在页面底部，确保操作便捷性。

## 模块功能 {#features}

**顶部导航栏**

- 固定在页面顶部，显示页面标题"发布动态"
- 提供返回上一页的功能按钮

**图片上传模块**

- 提供图片上传区域，支持多选上传
- 仅支持图片格式上传

**描述输入模块**

- 提供多行文本输入框，用于添加动态描述
- 最多输入 `500` 个字符
- 实时显示已输入字符数

**标签选择模块**

- 提供可横向滚动的标签列表
- 能够为所编辑内容多选标签，选中的标签状态会变化
- 标签内容通过 `getTagListApi` 方法，从 `mock` 处得到模拟数据

**位置选择模块**

提供位置选择入口，逻辑由开发者自行实现

**底部操作按钮模块**

- 本模块固定在页面底部，包含"存草稿"和"发布"两个按钮
- "存草稿"：将当前编辑内容保存为草稿，逻辑由开发者自行实现
- "发布"：将当前编辑内容发布到主页，成为正式动态

## 模块结构 {#structure}

**代码结构**

```
src/views/publish/
├── index.vue       // 发布页的主要组件所在，页面结构和布局
├── hooks.tsx       // 集成了发布页相关的业务逻辑
└── types.ts        // 定义及管理发布页相关的TypeScript类型
```

**index.vue**

该文件负责发布页的结构和布局

- 逻辑集成在 `hooks.tsx` 中，导入并使用 `usePublishHook` 获取发布页相关的状态和方法
- 模板部分包含顶部导航栏、图片上传区域、描述输入框、标签选择区域、位置选择入口和底部操作按钮
- 尽可能使用 TDesign 组件库的组件实现，例如 `t-upload`、`t-textarea`、`t-check-tag`、`t-cell` 和 `t-button` 等

**hooks.tsx**

该文件抽离了发布页的业务逻辑

- 定义 `usePublishHook` 函数，封装发布页的所有逻辑
- 从`types.ts`引入`FormData`类型，使用 `reactive` 创建响应式状态 `formData`，包含内容、文件、标签和位置信息
- 使用 `ref` 创建 `tags` 存储标签列表，用 `getTagListApi` 获取标签列表
- `uploadConfig` 配置基础上传参数

**types.ts**

该文件定义了发布页相关的 `TypeScript` 类型

- `TagItem`：标签项类型，包含id和label属性
- `FormData`：表单数据类型，包含content、files、tags和location属性
- 导出必要的类型供 `hooks` 使用

## 开发指南 {#development-guide}

1. **类型定义**：在 `types.ts` 中定义发布页所需的 `TypeScript` 类型
2. **业务逻辑开发**：在 `hooks.tsx` 中实现发布页的状态管理和业务逻辑
3. **页面整合**：在 `index.vue` 中引入 `hooks` 和所需组件，构建完整的页面布局和交互逻辑
4. **样式调整**：根据需求调整组件样式

## 扩展建议 {#ext}

1. **图片上传**：完善图片上传限制，支持图片预览
2. **图片编辑**：考虑添加图片裁剪、滤镜等编辑功能
3. **位置选择**：接入地图API，实现位置选择功能
4. **草稿管理**：完善保存草稿功能，支持查看和编辑历史草稿

## 贡献者 {#contributors}

[Tonite14](https://github.com/Tonite14)、[hikari](https://github.com/liuyax0818)
